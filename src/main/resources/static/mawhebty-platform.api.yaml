openapi: 3.0.3
info:
  title: Mawhebty platform api
  description: API for mawhebty platform end-points
  version: 1.0.0

servers:
  - url: http://localhost:3000/api/mawhebty-platform/v1
    description: Local development server
  - url: https://talent-scout-mu.vercel.app/
    description: Production server.

security:
  - ApiKeyAuth: []

paths:
  # User Profile APIs
  /profile/user:
    get:
      tags:
        - MawhebtyPlatformUserProfile
      summary: get user profile data
      description: get user profile data
      operationId: userProfile
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successful response with user profile data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileDataResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Follow/Unfollow APIs
  /profile/user/follow/{userId}:
    post:
      tags:
        - MawhebtyPlatformUserFollow
      summary: Follow a user
      description: Follow another user
      operationId: followUser
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successfully followed user
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /profile/user/unfollow/{userId}:
    post:
      tags:
        - MawhebtyPlatformUserFollow
      summary: Unfollow a user
      description: Unfollow a user you're following
      operationId: unfollowUser
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successfully unfollowed user
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /profile/user/followers:
    get:
      tags:
        - MawhebtyPlatformUserFollow
      summary: Get user followers
      description: Get list of users following the current user
      operationId: getUserFollowers
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of followers
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserFollowResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /profile/user/following:
    get:
      tags:
        - MawhebtyPlatformUserFollow
      summary: Get user following
      description: Get list of users the current user is following
      operationId: getUserFollowing
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of following users
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserFollowResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Saved Items APIs
  /profile/user/saved-items:
    get:
      tags:
        - MawhebtyPlatformUserSavedItems
      summary: Get user saved items
      description: Get user's saved posts, events, and articles
      operationId: getUserSavedItems
      security:
        - bearerAuth: [ ]
      parameters:
        - name: item_type
          in: query
          description: Filter by item type (1=posts, 2=events, 3=articles)
          required: false
          schema:
            type: integer
            enum: [ 1, 2, 3 ]
        - name: page
          in: query
          description: Page number
          required: false
          schema:
            type: integer
            default: 1
        - name: per_page
          in: query
          description: Items per page
          required: false
          schema:
            type: integer
            default: 10
            maximum: 50
      responses:
        '200':
          description: List of saved items
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SavedItemsData'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Events CRUD APIs
  /events:
    get:
      tags:
        - Events
      summary: Get list of events
      description: Get events with optional filtering and pagination
      operationId: getEvents
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          description: Filter by event status
          required: false
          schema:
            type: string
            enum: [UPCOMING, ONGOING, COMPLETED, CANCELLED]
        - name: type
          in: query
          description: Filter by event type
          required: false
          schema:
            type: string
            enum: [GENERAL, WORKSHOP, CONFERENCE]
        - name: is_free
          in: query
          description: Filter free events only
          required: false
          schema:
            type: boolean
        - name: search
          in: query
          description: Search in title, description, location, tags
          required: false
          schema:
            type: string
        - name: page
          in: query
          description: Page number
          required: false
          schema:
            type: integer
            default: 1
        - name: per_page
          in: query
          description: Items per page
          required: false
          schema:
            type: integer
            default: 10
            maximum: 50
        - name: start_date
          in: query
          description: Filter events starting from this date
          required: false
          schema:
            type: string
            format: date-time
        - name: end_date
          in: query
          description: Filter events ending before this date
          required: false
          schema:
            type: string
            format: date-time
        - name: sort_by
          in: query
          description: Sort by date desc/asc
          required: false
          example: date_desc, date_asc
          schema:
            type: string
      responses:
        '200':
          description: List of events
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventListResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /events/{id}:
    get:
      tags:
        - Events
      summary: Get event by ID
      description: Get event with related details by ID
      operationId: getEventById
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: number
      responses:
        '200':
          description: Event with related details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventWithRelatedResponse'
        '404':
          description: Event not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /events/{id}/register:
    post:
      tags:
        - Events
      summary: Register for event
      description: Register current user for an event
      operationId: registerForEvent
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successfully registered for event
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EventRegistrationResponse'
        '400':
          description: Bad request (event full, already registered, etc.)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Event not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Articles CRUD APIs
  /articles:
    get:
      tags:
        - Articles
      summary: Get list of articles
      description: Get articles with optional filtering and pagination
      operationId: getArticles
      security:
        - bearerAuth: []
      parameters:
        - name: category_id
          in: query
          description: Filter by category ID
          required: false
          schema:
            type: integer
        - name: sub_category_id
          in: query
          description: Filter by sub-category ID
          required: false
          schema:
            type: integer
        - name: search
          in: query
          description: Search in title, description, tags
          required: false
          schema:
            type: string
        - name: page
          in: query
          description: Page number
          required: false
          schema:
            type: integer
            default: 1
        - name: per_page
          in: query
          description: Items per page
          required: false
          schema:
            type: integer
            default: 10
            maximum: 50
        - name: sort_by
          in: query
          description: Sort by date desc/asc
          required: false
          example: date_desc, date_asc
          schema:
            type: string
      responses:
        '200':
          description: List of articles
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ArticleListResponse'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'


  /articles/{id}:
    get:
      tags:
        - Articles
      summary: Get article by ID
      description: Get article details with sections
      operationId: getArticleById
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Article details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ArticleResponse'
        '404':
          description: Article not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /articles/{id}/sections:
    get:
      tags:
        - Articles
      summary: Get article sections
      description: Get all sections of an article
      operationId: getArticleSections
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: List of article sections
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ArticleSectionResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Article not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Home APIs
  /home/sections:
    get:
      tags:
        - MawhebtyPlatformHomeSections
      summary: Get home sections related to user category and subcategory
      description: Get home sections posts, events, and articles
      operationId: getHomeSections
      security:
        - bearerAuth: [ ]
      parameters:
        - name: per_section_items_count
          in: query
          description: Number of items for each section
          required: false
          schema:
            type: number
            default: 5
      responses:
        '200':
          description: Home sections posts, events, and articles
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HomeSectionsData'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: x-api-key
      description: API key for authentication
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    # Base Error Response
    ErrorResponse:
      type: object
      properties:
        error:
          type: string
        code:
          type: string
        timestamp:
          type: string
          format: date-time
      required:
        - error
        - code
        - timestamp

    # OTP Response
    OTPGenerationResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        nextStep:
          type: string
        verificationUrl:
          type: string
        otpExpiresAt:
          type: string
          format: date-time

    # User Profile Responses
    UserProfileDataResponse:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/userProfile'
        category:
          $ref: '#/components/schemas/category'
        subcategory:
          $ref: '#/components/schemas/subcategory'
        talent_type:
          $ref: '#/components/schemas/talentType'

    userProfile:
      type: object
      properties:
        id:
          type: integer
        first_name:
          type: string
        last_name:
          type: string
        contact_person:
          type: string
        contact_phone:
          type: string
        phone:
          type: string
        country_code:
          type: string
        user_status:
          type: integer
        user_role:
          type: integer
        image_url:
          type: string
        short_bio:
          type: string
        age:
          type: integer
        country:
          type: string
        city:
          type: string
        followers:
          type: integer
        following:
          type: integer

    category:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string

    subcategory:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string

    talentType:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string

    UserFollowResponse:
      type: object
      properties:
        userId:
          type: integer
        firstName:
          type: string
        lastName:
          type: string
        imageUrl:
          type: string
        shortBio:
          type: string
        followedAt:
          type: string
          format: date-time

    # Saved Items Responses
    SavedItemsData:
      type: object
      properties:
        posts:
          type: array
          items:
            $ref: '#/components/schemas/SavedPost'
        events:
          type: array
          items:
            $ref: '#/components/schemas/SavedEvent'
        articles:
          type: array
          items:
            $ref: '#/components/schemas/SavedArticle'

    SavedPost:
      type: object
      properties:
        id:
          type: integer
        owner:
          $ref: '#/components/schemas/PostOwner'
        title:
          type: string
        description:
          type: string
        image_url:
          type: string
        date:
          type: string
          format: date-time
        saved_at:
          type: string
          format: date-time

    SavedEvent:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        description:
          type: string
        location:
          type: string
        location_coordinates:
          type: string
        image_url:
          type: string
        date:
          type: string
          format: date-time
        saved_at:
          type: string
          format: date-time

    SavedArticle:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        description:
          type: string
        date:
          type: string
          format: date-time
        image_url:
          type: string
        category_name:
          type: string
        sub_category_name:
          type: string
        saved_at:
          type: string
          format: date-time

    PostOwner:
      type: object
      properties:
        id:
          type: integer
        first_name:
          type: string
        last_name:
          type: string
        image_url:
          type: string
    # Events Schemas
    EventResponse:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        description:
          type: string
        event_date:
          type: string
          format: date-time
        end_date:
          type: string
          format: date-time
        location:
          type: string
        location_coordinates:
          type: string
        cover_image_url:
          type: string
        status:
          type: string
        type:
          type: string
        max_attendees:
          type: integer
        current_attendees:
          type: integer
        is_free:
          type: boolean
        ticket_price:
          type: number
        registration_url:
          type: string
        event_link:
          type: string
        tags:
          type: string
        category_id:
          type: number
        sub_category_id:
          type: number
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    EventWithRelatedResponse:
      type: object
      properties:
        id:
          type: number
        title:
          type: string
        description:
          type: string
        date:
          type: string
          format: date-time
        end_date:
          type: string
          format: date-time
        location:
          type: string
        location_coordinates:
          type: string
        image_url:
          type: string
        status:
          type: string
        type:
          type: string
        max_attendees:
          type: integer
        current_attendees:
          type: integer
        is_free:
          type: boolean
        ticket_price:
          type: number
        registration_url:
          type: string
        event_link:
          type: string
        tags:
          type: string
        related_events:
          type: array
          description: "Up to 5 related events based on category and sub-category"
          items:
            $ref: '#/components/schemas/EventSummary'



    EventListResponse:
      type: object
      properties:
        total_items:
          type: number
        current_page:
          type: integer
        per_page:
          type: integer
        total_pages:
          type: integer
        events:
          type: array
          items:
            $ref: '#/components/schemas/EventListItem'

    EventListItem:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        description:
          type: string
        location:
          type: string
        image_url:
          type: string
        date:
          type: string
          format: date-time

    EventSummary:
      type: object
      properties:
        id:
          type: number
        title:
          type: string
        description:
          type: string
        location:
          type: string
        image_url:
          type: string
        date:
          type: string
          format: date-time

    EventRegistrationResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        registration_id:
          type: integer
        event_id:
          type: integer
        user_id:
          type: integer
        registered_at:
          type: string
          format: date-time

    # Articles Schemas
    ArticleResponse:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        cover_image_url:
          type: string
        category:
          $ref: '#/components/schemas/category'
        sub_category:
          $ref: '#/components/schemas/subcategory'
        status:
          type: string
        tags:
          type: string
        published_at:
          type: string
          format: date-time
        sections:
          type: array
          items:
            $ref: '#/components/schemas/ArticleSectionResponse'

    ArticleListResponse:
      type: object
      properties:
        total_items:
          type: number
        current_page:
          type: integer
        per_page:
          type: integer
        total_pages:
          type: integer
        articles:
          type: array
          items:
            $ref: '#/components/schemas/ArticleSummary'

    ArticleSummary:
      type: object
      properties:
        id:
          type: number
        title:
          type: string
        image_url:
          type: string
        category_name:
          type: string
        sub_category_name:
          type: string
        published_at:
          type: string
          format: date-time

    ArticleSectionResponse:
      type: object
      properties:
        id:
          type: integer
        section_order:
          type: integer
        title:
          type: string
        content:
          type: string
        image_url:
          type: string
        video_url:
          type: string
        embed_code:
          type: string

    HomeSectionsData:
      type: object
      properties:
        posts:
          type: array
          items:
            $ref: '#/components/schemas/PostSection'
        events:
          type: array
          items:
            $ref: '#/components/schemas/EventSection'
        articles:
          type: array
          items:
            $ref: '#/components/schemas/ArticleSection'

    PostSection:
      type: object
      properties:
        id:
          type: number
        owner:
          $ref: '#/components/schemas/PostOwner'
        title:
          type: string
        description:
          type: string
        image_url:
          type: string
        date:
          type: string
          format: date-time

    EventSection:
      type: object
      properties:
        id:
          type: number
        title:
          type: string
        description:
          type: string
        location:
          type: string
        location_coordinates:
          type: string
        image_url:
          type: string
        date:
          type: string
          format: date-time

    ArticleSection:
      type: object
      properties:
        id:
          type: number
        title:
          type: string
        description:
          type: string
        date:
          type: string
          format: date-time
        image_url:
          type: string
        category_name:
          type: string
        sub_category_name:
          type: string
